# 2956 疲劳值

## 题目描述

所有的世界线构成了一张有向无环图（无重边，1 号点入度为零，$$n$$ 号点出度为零），每一个节点代表了某一个世界线的某一个时间点。冈部伦太郎的目标是从初始世界线的初始时刻，即 1 号节点，到达命运石之门世界线，即 $$n$$ 号节点。纵使冈部伦太郎已经经历过很多结局，他依然不知道什么行为会导致前往什么世界线，所以对于每一个节点 $$u$$，冈部伦太郎都会等概率随机选择一条从 $$u$$ 出发的边，并走这条边。

因为冈部伦太郎拥有“探知之眼（Reading Steiner）”能力，他可以随时知道自己在哪一个节点和整张有向无环图的全貌。

在不同的时间节点，会有不同的事件发现，其中最有意义的就是造出时间跳跃机（造出时间跳跃机后，走到的后续节点也可以使用时间跳跃机）。拥有时间跳跃机后，可以将时间回溯到上一个时间节点，即如果当前所在的节点 $$u$$ 是从 $$v$$ 到达的，那就可以回溯到节点 $$v$$。当然，如果你一开始在 $$v$$ 节点时尚未拥有时间跳跃机，回溯到 $$v$$ 节点后还是没有时间跳跃机。

除了希望到达命运石之门世界线外，冈部伦太郎还希望自己的疲劳程度最小。每当经过一条边时，冈部伦太郎会获得相应的疲劳值，使用时间跳跃机时，也会获得相应的疲劳值。（使用时间跳跃机并不能消除在当前节点获得的疲劳值）

请告诉冈部伦太郎，在最优策略下，冈部伦太郎期望会有多少疲劳值。

## 输入格式

第一行读入 $$n,\,m,\,k$$，表示点数、边数和使用时间跳跃机获得的疲劳值。

第二行读入 $$n$$ 个数 $$a_1 \dots a_n$$，表示这个时间点有没有造出时间跳跃机，`0` 表示没有，`1` 表示有。

接下来 $$m$$ 行，每行读入 3 个数 $$u,\,v,\,w$$，表示这条边的起点、终点和经过这条边时获得的疲劳值。

## 输出格式

输出在最优策略下，冈部伦太郎期望会有多少疲劳值，保留 4 位小数。

## 输入样例

{% code-tabs %}
{% code-tabs-item title="sample.in" %}
```text
3 3 1
0 1 0
1 3 1
1 2 1
2 3 10
```
{% endcode-tabs-item %}
{% endcode-tabs %}

## 输出样例

{% code-tabs %}
{% code-tabs-item title="sample.out" %}
```text
3.0000
```
{% endcode-tabs-item %}
{% endcode-tabs %}

## 样例解释

策略有两种：

* 在到达 2 号节点时回溯，期望疲劳值为 3.0000；
* 在到达 2 号节点时不回溯，期望疲劳值为 6.0000。

## 数据范围

对于所有数据，满足 $$1 \leq n \leq 10^5$$，$$1 \leq m \leq 2 \times 10^5$$，$$1 \leq k,\,w \leq 10$$，保证每一个节点都可以到达 $$n$$ 号点，每一个节点都可以被 1 号点到达。

| SubTask 编号 | 分数 | 特殊性质 |
| :---: | :---: | :---: |
| 1 | 20 | $$1 \leq n \leq 10,\ 1 \leq m \leq 20$$ |
| 2 | 30 | $$\sum_{i=1}^n a_i = 0$$ |
| 3 | 20 | $$a_1 = 1$$ |
| 4 | 20 | $$1 \leq n \leq 100,\ 1 \leq m \leq 200$$，数据随机生成 |
| 5 | 10 | 无 |

