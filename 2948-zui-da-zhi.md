# 2948 最大值

## 题目描述

Maxtir 有 $$n$$ 个横向摆放的魔法阵，启动一个魔法阵要使用魔法晶石。

一个魔法晶石有三种属性，$$(x_i,\,y_i,\,p_i)$$，表示它有 $$p_i$$ 的概率在第 $$x_i$$ 个魔法阵上出现，其能量为 $$y_i$$。对于任意的魔法晶石，都有 $$0 \leq y_i \leq k$$，$$k$$ 为给定的常数。

任意一个时刻，某个魔法阵的能量 $$v_i$$ 为在这个魔法阵上的所有魔法晶石的最小值，特殊地，规定没有魔法晶石的魔法阵能量为 0。

现在 Maxtir 有 $$m$$ 个魔法晶石，以及 $$q$$ 次启动魔法阵的机会，第 $$i$$ 次，他可以从第 $$l_i$$ 到第 $$r_i$$ 个魔法阵吸取能量，其吸取的能量为所有魔法阵的最大能量，即 $$A_i = \max_{j=l_i}^{r_i} v_j$$（同上一题类似地规定 $$\max_{i=x}^x v_i = v_x$$）。同时，保证 $$[l_i,\,r_i]$$ 互不包含，否则会出现不可描述的问题。

现在，他希望知道他 $$q$$ 次吸取的能量的期望值之和，在模 $$10^9 + 7$$ 意义下告诉他答案即可。

## 输入格式

第一行输入四个正整数 $$n,\,m,\,q$$。

第二行至第 $$n + 1$$ 行中，第 $$i + 1$$ 行输入魔法晶石 $$i$$ 的三种属性 $$(x_i,\,y_i,\,p_i)$$。

接下来 $$q$$ 行，每行两个正整数 $$l_i,\,r_i$$，数据保证 $$[l_i,\,r_i]$$ 互不包含。

## 输出格式

输出一行一个正整数 $$ans$$ 表示答案。

## 输入样例

{% code-tabs %}
{% code-tabs-item title="sample.in" %}
```text
3 3 2
1 1 500000004 
2 2 333333336
3 3 1
1 2
2 3
```
{% endcode-tabs-item %}
{% endcode-tabs %}

## 输出样例

{% code-tabs %}
{% code-tabs-item title="sample.out" %}
```text
4
```
{% endcode-tabs-item %}
{% endcode-tabs %}

## 样例解释

$$500000004 \equiv \frac{1}{2} \mod(10^9 + 7)$$，$$333333336 \equiv \frac{1}{3} \mod(10^9 + 7)$$

最终的魔法阵中的晶石序列可能是 $$(\otimes,\,\otimes,\,3),\ (\otimes,\,2,\,3),\ (1,\,\otimes,\,3),\ (1,\,2,\,3)$$ 四种，他们的概率分别是 $$\frac{1}{3},\,\frac{1}{6},\,\frac{1}{3},\,\frac{1}{6}$$，两次吸取的能量分别是 $$(0,\,3),\ (2,\,3),\ (1,\,3),\ (2,\,3)$$，最终的答案是 $$5 \times \frac{1}{3} + 5 \times \frac{1}{6} + 4 \times \frac{1}{3} + 5 \times \frac{1}{6} = 4$$。

## 数据范围

对于所有数据，满足 $$0 \leq y_i \leq 10^9$$，$$1 \leq q \leq n$$，$$0 \leq p_i \leq 10^9 + 7$$。

| 测试点 | 范围 | 特殊性质 |
| :---: | :---: | :---: |
| 1 | $$1 \leq n,\,m \leq 20$$ | 无 |
| 2-3 | $$1 \leq n \leq 100,\,1 \leq m \leq 500$$ | 无 |
| 4 | $$1 \leq n \leq 10^3,\,1 \leq m \leq 5 \times 10^3$$ | 无 |
| 5 | $$1 \leq n \leq 10^5,\,1 \leq m \leq 2 \times 10^5$$ | $$q = n$$ |
| 6 | $$1 \leq n \leq 10^5,\,1 \leq m \leq 2 \times 10^5$$ | $$q = n - 1$$ |
| 7-10 | $$1 \leq n \leq 10^5,\,1 \leq m \leq 2 \times 10^5$$ | 无 |

