# 2655 dfs序

## 题目描述

给出一棵点数为 $$n$$ 的树和一个排列 $$a$$。

一个人先随机从树上选择一个点 $$s$$ 作为根并到达 $$s$$，然后按照下列过程操作：

1. 每到达一个点，将这个点加入 $$b$$ 数组；
2. 如果这个点还有未访问过的邻居，则从它们中随机选一个邻居 $$v$$ 并到达 $$v$$；
3. 如果这个点没有未访问过的邻居，如果这个点就是根，那么结束。否则找到这个点离根最近的一个邻居 $$v$$，并到达 $$v$$。

最后得到一个排列 $$b$$，现在问有多少个可能的排列 $$b$$ 使得它字典序严格小于排列 $$a$$，答案模 `1000000007`。

## 输入格式

第一行一个 ****$$t$$ 表示数据组数。

每组数据第一行一个整数 $$n$$，表示树的点数。

接下来一行有 $$n$$ 个数，表示序列 $$a$$。

接下来有 $$n-1$$ 行，每行两个正整数 $$x,\,y$$，树上有边 $$x \leftrightarrow y$$。

## 输出格式

对于每组测试数据，输出答案模 `1000000007`。

## 输入样例

{% code-tabs %}
{% code-tabs-item title="sample.in" %}
```text
2
5
2 1 3 5 4
1 2
2 3
2 4
4 5
6
6 4 5 3 2 1
1 2
2 3
3 4
4 5
5 6
```
{% endcode-tabs-item %}
{% endcode-tabs %}

## 输出样例

{% code-tabs %}
{% code-tabs-item title="sample.out" %}
```text
3
9
```
{% endcode-tabs-item %}
{% endcode-tabs %}

## 数据范围

| 测试点 | 范围 |
| :---: | :---: |
| 20% | $$1 \leq n \leq 10$$ |
| 50% | $$1 \leq n \leq 10^3$$ |
| 100% | $$1 \leq n \leq 10^5,\ 1 \leq t \leq 5$$ |

数据保证给出的是一棵树。

## 来源

[HDU 6338](http://acm.hdu.edu.cn/showproblem.php?pid=6338)

